!function(t,i,o){function r(){function e(){return navigator.platform.indexOf("Mac")>-1?"mac":navigator.platform.indexOf("Win")>-1?"windows":null}function o(t,e){return!!(null!==t&&"mac"==t&&e.metaKey||"windows"==t&&e.ctrlKey)}t.onload=function(){this.visit={Org_ID:i,visitTime:(new Date).getTime(),document:this.getDoc(),Offers:this.getOffers()},this.visit.Web_user_id=this.getLead(),this.visit.session_id=this.getSession(),this.visit.Visit_id=this.getVisit();var t=this.setLocalStorage("lastPost");t&&this.postData(t,!0),this.postData(this.visit)}.bind(this),t.onmousedown=function(t){var i=t.target,r="A"==i.tagName;if(r){var n=e(),s=o(n,t),a=i.getAttribute("href"),f=this.isValidLink(a);if(n&&s&&f){var u={href:a,visitId:this.getVisit(),time:(new Date).getTime()},c=this.getLocalStorage("visitCont")||[];c.push(u),this.setLocalStorage("visitCont",c)}}}.bind(this)}function n(t){"string"!=typeof t&&(t=JSON.stringify(t));try{return JSON.parse(t),!0}catch(e){return!1}}if(r.prototype.isValidLink=function(t){if(t)return t.search(".")>-1||t.search("/")>-1},r.prototype.tryStringfy=function(t){try{var e=JSON.stringify(t);if(e&&"string"==typeof e)return e}catch(i){}return t},r.prototype.tryParse=function(t){try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(i){}return t},r.prototype.getLocalStorage=function(t){if("undefined"!=typeof Storage)return this.tryParse(localStorage.getItem(t))},r.prototype.setLocalStorage=function(t,e){"undefined"!=typeof Storage&&(null==e?localStorage.removeItem(t):(e=this.tryStringfy(e),localStorage.setItem(t,e)))},r.prototype.getLead=function(){return this.visit.document.cookie.bfLead?this.visit.document.cookie.bfLead:this.getStorageLead()?this.getStorageLead():this.setLead()},r.prototype.getSession=function(){return this.visit.document.cookie.bfSession?this.visit.document.cookie.bfSession:this.getStorageSession()?this.getStorageSession():this.setSession()},r.prototype.cleanUpAndCheck=function(t){var e=(new Date).getTime(),i=!1,o=[];return t.forEach(function(t,r){e-t.time<6e5&&window.location.href.indexOf(t.href)!==-1&&(i=t.visitId,o.push(t))}),0===o.length?delete localStorage.visitCont:this.setLocalStorage("visitCont",o),i},r.prototype.getVisit=function(){if("undefined"!=typeof Storage){var t,e=this.getLocalStorage("visitCont");return e&&e.length>0&&(t=this.cleanUpAndCheck(e)),t?t:sessionStorage.bfVisit?sessionStorage.bfVisit:this.setVisit()}},r.prototype.setCookie=function(t,e,i){if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3);var r="; expires="+o.toUTCString()}else var r="";return document.cookie=t+"="+e+r+"; path=/",this.visit.document.cookie[t]=e,e},r.prototype.getStorageLead=function(){if("undefined"!=typeof Storage){var t=localStorage.getItem("bfLead");return t&&this.setCookie("bfLead",t,360),t}},r.prototype.getStorageSession=function(){if("undefined"!=typeof Storage){var t=localStorage.getItem("bfSession");return t&&this.setCookie("bfSession",t,o),t}},r.prototype.setLead=function(){var t=this.generateId();return"undefined"!=typeof Storage&&localStorage.setItem("bfLead",t),this.setCookie("bfLead",t,360)},r.prototype.setSession=function(){var t=this.generateId();return"undefined"!=typeof Storage&&localStorage.setItem("bfSession",t),this.setCookie("bfSession",t,o)},r.prototype.setVisit=function(){var t=this.generateId();return"undefined"!=typeof Storage&&sessionStorage.setItem("bfVisit",t),t},r.prototype.getDoc=function(){var e={},i=["URL","referrer","cookie","title"];for(var o in t.document)i.indexOf(o)!==-1&&(e[o]=t.document[o]);return e.URL_params=this.queryObj(e.URL),e.referrer_params=this.queryObj(e.referrer),e.cookie=this.cookieObj(e.cookie),e.device=this.userAgent(),e.screen={height:screen.height,width:screen.width},e},r.prototype.cookieObj=function(t){t=t.split("; ");for(var e={},i=0;i<t.length;i++){var o=t[i].split("="),r=unescape(o[1]);e[o[0]]=n(r)?JSON.parse(r):r}return e},r.prototype.queryObj=function(t){if(t.indexOf("?")!==-1){t=t.split("?")[1];var e={},i=t.split("&");return i.forEach(function(t){var i=t.split("=");if(e[i[0]])if($.isArray(e[i[0]]))e[i[0]].push(i[1]);else{var o=e[i[0]];e[i[0]]=[],e[i[0]].push(o),e[i[0]].push(i[1])}else e[i[0]]=i[1]}),e}},r.prototype.generateId=function(){return(Math.floor(1e20*Math.random()+1)+(new Date).getTime()).toString(32)},r.prototype.getOffers=function(){var t=parent.document.getElementsByTagName("form"),e=["mktoForm_","hubspotform-","hsForm_"],i=[],o=[];console.log(t);for(var r=0;r<t.length;r++){for(var n=t[r],s=n.getAttribute("action"),a=s&&s.indexOf(".t.eloqua.com")!==-1,f=s&&s.indexOf("go.pardot.com")!==-1,u=s&&s.indexOf("forms.hubspot.com")!==-1,c="register"==n.getAttribute("id")&&location.hostname.indexOf("cloudera")>-1,d=n.id,g=!1,h=0;h<e.length;h++){g=d&&d.indexOf(e[h])!==-1||a||f||u||c;break}if(g&&!this.isHidden(n)&&o.indexOf(n.action)===-1){var p={type:"form",data:this.getFormData(n),submitted:!1};p.data&&i.push(p),o.push(n.action),n.addEventListener("submit",function(t,e){this.getFormData(t,!0)&&(this.visit.Offers[e].data=this.getFormData(t),this.visit.Offers[e].submitted=!0,this.setLocalStorage("lastPost",this.visit),this.postData(this.visit,!0))}.bind(this,n,i.length-1))}}return i},r.prototype.isHidden=function(t){var e=window.getComputedStyle(t);return"none"===e.display},r.prototype.getFormData=function(t,i){var o=t.elements,r={};for(e=0;e<o.length;e++)o[e].name.length&&o[e].value&&(i&&"hidden"!=o[e].type&&o[e].value?r[o[e].name]=o[e].value:i||(r[o[e].name]=o[e].value));return Object.keys(r).length?r:null},r.prototype.postData=function(t,e){var i=this,o=new XMLHttpRequest;o.withCredentials=!1,o.open("POST","https://api.brightfunnel.com/v1/sd",void 0===e||e),o.setRequestHeader("accept","application/json"),o.setRequestHeader("content-type","application/x-www-form-urlencoded"),o.addEventListener("readystatechange",function(){this.readyState===this.DONE&&i.setLocalStorage("lastPost",null)}),o.send(JSON.stringify(t))},r.prototype.userAgent=function(){var t={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},Chrome:function(){return!!window.chrome},Firefox:function(){return navigator.userAgent.match(/firefox/i)}};return t.Android()?"android":t.BlackBerry()?"BlackBerry":t.iOS()?"ios":t.Opera()?"opera":t.Windows()?"windows mobile":t.Chrome()?"desktop chrome":t.Firefox()?"desktop firefox":"desktop other"},i){new r}}(window,bfId,bfSession);